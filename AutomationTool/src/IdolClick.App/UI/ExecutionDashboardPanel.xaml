<UserControl x:Class="IdolClick.UI.ExecutionDashboardPanel"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             Background="Transparent">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Border Grid.Row="0" Background="{StaticResource CardBrush}" CornerRadius="6,6,0,0" Padding="12,8">
            <Grid>
                <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                    <TextBlock Text="ðŸ“Š" FontSize="14" VerticalAlignment="Center" Margin="0,0,6,0"/>
                    <TextBlock Text="Execution" FontSize="12" FontWeight="SemiBold"
                               Foreground="{StaticResource TextBrush}" VerticalAlignment="Center"/>
                    <TextBlock x:Name="ExecutionStatus" Text="  â€¢  Idle" FontSize="10"
                               Foreground="{StaticResource TextSecondaryBrush}" VerticalAlignment="Center"/>
                </StackPanel>
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Center">
                    <TextBlock x:Name="ElapsedText" Text="" FontSize="10"
                               Foreground="{StaticResource TextSecondaryBrush}"
                               VerticalAlignment="Center" Margin="0,0,8,0"/>
                    <Button x:Name="ClearBtn" Content="Clear" 
                            Style="{StaticResource SmallButton}"
                            Click="Clear_Click" Width="50" Height="22"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Step List -->
        <ListView x:Name="StepsListView" Grid.Row="1" BorderThickness="0"
                  Background="{StaticResource SurfaceBrush}" FontSize="11"
                  ScrollViewer.HorizontalScrollBarVisibility="Disabled">
            <ListView.ItemContainerStyle>
                <Style TargetType="ListViewItem">
                    <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                    <Setter Property="Padding" Value="10,6"/>
                    <Setter Property="Margin" Value="0"/>
                    <Setter Property="Foreground" Value="{StaticResource TextBrush}"/>
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="ListViewItem">
                                <Border x:Name="Bd" Background="Transparent"
                                        Padding="{TemplateBinding Padding}"
                                        BorderBrush="{StaticResource BorderSubtleBrush}"
                                        BorderThickness="0,0,0,1">
                                    <ContentPresenter/>
                                </Border>
                                <ControlTemplate.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter TargetName="Bd" Property="Background" Value="{StaticResource ActivityBarHoverBrush}"/>
                                    </Trigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Style>
            </ListView.ItemContainerStyle>
            <ListView.ItemTemplate>
                <DataTemplate>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="24"/>
                            <ColumnDefinition Width="20"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="50"/>
                        </Grid.ColumnDefinitions>
                        <!-- Step number -->
                        <TextBlock Grid.Column="0" Text="{Binding StepNumber}"
                                   Foreground="{StaticResource TextSecondaryBrush}"
                                   FontSize="10" VerticalAlignment="Center"
                                   FontFamily="{StaticResource MonoFont}"/>
                        <!-- Status icon -->
                        <TextBlock Grid.Column="1" Text="{Binding StatusIcon}"
                                   FontSize="12" VerticalAlignment="Center"/>
                        <!-- Action + selector -->
                        <StackPanel Grid.Column="2" VerticalAlignment="Center" Margin="4,0">
                            <TextBlock Text="{Binding ActionLabel}" FontSize="11"
                                       Foreground="{StaticResource TextBrush}" TextTrimming="CharacterEllipsis"/>
                            <TextBlock Text="{Binding SelectorLabel}" FontSize="9.5"
                                       Foreground="{StaticResource TextSecondaryBrush}"
                                       TextTrimming="CharacterEllipsis"/>
                        </StackPanel>
                        <!-- Confidence -->
                        <TextBlock Grid.Column="3" Text="{Binding ConfidenceLabel}"
                                   FontSize="9" VerticalAlignment="Center"
                                   Foreground="{StaticResource TextSecondaryBrush}"
                                   Margin="4,0"/>
                        <!-- Duration -->
                        <TextBlock Grid.Column="4" Text="{Binding DurationLabel}"
                                   FontSize="10" VerticalAlignment="Center"
                                   Foreground="{StaticResource TextSecondaryBrush}"
                                   HorizontalAlignment="Right"
                                   FontFamily="{StaticResource MonoFont}"/>
                    </Grid>
                </DataTemplate>
            </ListView.ItemTemplate>
        </ListView>

        <!-- Empty state -->
        <StackPanel x:Name="EmptyState" Grid.Row="1" VerticalAlignment="Center" HorizontalAlignment="Center">
            <TextBlock Text="ðŸ“Š" FontSize="28" HorizontalAlignment="Center" Margin="0,0,0,8"/>
            <TextBlock Text="No execution data" FontSize="12" Foreground="{StaticResource TextSecondaryBrush}"
                       HorizontalAlignment="Center"/>
            <TextBlock Text="Run a flow or pack to see live progress here."
                       FontSize="10.5" Foreground="{StaticResource TextSecondaryBrush}"
                       HorizontalAlignment="Center" Margin="0,4,0,0"/>
        </StackPanel>

        <!-- Summary bar -->
        <Border Grid.Row="2" Background="{StaticResource CardBrush}" Padding="10,6" CornerRadius="0,0,6,6">
            <Grid>
                <StackPanel Orientation="Horizontal">
                    <TextBlock x:Name="PassedText" Text="0 passed" FontSize="10"
                               Foreground="{StaticResource SuccessBrush}" VerticalAlignment="Center"/>
                    <TextBlock Text="  â€¢  " FontSize="10" Foreground="{StaticResource TextSecondaryBrush}" VerticalAlignment="Center"/>
                    <TextBlock x:Name="FailedText" Text="0 failed" FontSize="10"
                               Foreground="{StaticResource ErrorBrush}" VerticalAlignment="Center"/>
                    <TextBlock Text="  â€¢  " FontSize="10" Foreground="{StaticResource TextSecondaryBrush}" VerticalAlignment="Center"/>
                    <TextBlock x:Name="TotalText" Text="0 steps" FontSize="10"
                               Foreground="{StaticResource TextSecondaryBrush}" VerticalAlignment="Center"/>
                </StackPanel>
                <!-- Confidence score -->
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                    <TextBlock x:Name="ConfidenceText" Text="" FontSize="10"
                               Foreground="{StaticResource PrimaryBrush}" FontWeight="SemiBold"
                               VerticalAlignment="Center"/>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</UserControl>
